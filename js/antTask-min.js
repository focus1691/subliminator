"use strict";function displayCueInformation(){var e=0,t=0;showCue(cue[t],instructPath,e),showCueInfo(cue[t],cueInstruct[t],e),showCue(cue[++t],instructPath,e+=3500),showCueInfo(cue[t],cueInstruct[t],e),showCue(cue[++t],instructPath,e+=3500),showCueInfo(cue[t],cueInstruct[t],e),showStimulus(freudStimuliPath,stImage[6],e+=3500),showCue(cue[++t],instructPath,e+=3500),showCueInfo(cue[t],cueInstruct[t],e),showStimulus(freudStimuliPath,stImage[0],e+=3500),showCue(cue[++t],instructPath,e+=3500),showCueInfo(cue[t],cueInstruct[t],e),showStimulus(freudStimuliPath,stImage[0],e+=3500),showStimulus(freudStimuliPath,stImage[6],e+=1500),clearStimulus(e+=1500),clearCueInstruction(e),instructUser("M",e+=5e3),showStimulus(freudStimuliPath,stImage[0],e),showStimulus(instructPath,stImage[0],e+=1e3),clearKeyboardInstructions(e+=3500),clearStimulus(e),instructUser("Z",e+=250),showStimulus(freudStimuliPath,stImage[9],e),showStimulus(instructPath,stImage[9],e+=1e3),clearKeyboardInstructions(e+=5e3),clearStimulus(e),runTrialBlock(e+=500)}function runTrialBlock(e){trialCounter=0,shuffle(condition),setTimeout(function(){theTask=setInterval(function(){runTrial()},toa)},e)}function responseInfo(){}function runTrial(){if(trialCounter<trials){clearFeedbackInfo(),clearKeyboardInstructions(),shuffle(loadTime),0==trialCounter&&($(".tab li #antFeedbackResults").addClass("activeTab"),$(".tab li #antFeedbackInstruct").removeClass("activeTab"));var e=condition[++trialCounter];updateTrialInfo(e),showFixation(e,0),clearCueInstruction(0),loadTime[0]=100,showCue(cue[activeCue[e]],cuePath,loadTime[0]),findCueInfo(cue[activeCue[e]],loadTime[0]),showFixation(e,loadTime[0]+cueTime),clearCueInstruction(loadTime[0]+cueTime),getKeypress(e,loadTime[0]+cueTime+postCueFixTime),checkResponse(loadTime[0]+cueTime+postCueFixTime+maxTgTime,e)}else clearInterval(theTask),submitData()}function clearKeyboardInstructions(e){setTimeout(function(){"visible"==$("#zKey").css("visibility")&&$("#zKey").css("visibility","hidden"),"visible"==$("#mKey").css("visibility")&&$("#mKey").css("visibility","hidden"),"visible"==$("#bothKeys").css("visibility")&&$("#bothKeys").css("visibility","hidden")},e)}function clearFeedbackInfo(){"visible"==$("#errorTitle").css("visibility")&&$("#errorTitle").css("visibility","hidden"),"visible"==$("#rewardTitle").css("visibility")&&$("#rewardTitle").css("visibility","hidden")}function clearStimulus(e){setTimeout(function(){$("#stimuli").attr("src","images/ant/cues/blank.png")},e)}function shuffle(e){for(var t,i,s=e.length;s>0;)i=Math.floor(Math.random()*s),s--,t=e[s],e[s]=e[i],e[i]=t;return e}function updateTrialInfo(e){addTrialCue(e),addTrialAnswer(e),addTrialCondition(e),addTrialCongruency(stType[e],congruenceArr)}function addTrialCue(e){cueArr.push(cue[activeCue[e]])}function addTrialAnswer(e){ansArr.push(ansKey[e])}function addTrialCondition(e){condArr.push(e)}function addTrialCongruency(e,t){switch(t.push(0),e){case 0:t[t.length-1]="n";break;case 1:t[t.length-1]="c";break;case 2:t[t.length-1]="i";break;case 3:t[t.length-1]="n";break;case 4:t[t.length-1]="c";break;case 5:t[t.length-1]="i";break;case 6:t[t.length-1]="n";break;case 7:t[t.length-1]="c";break;case 8:t[t.length-1]="i";break;case 9:t[t.length-1]="n";break;case 10:t[t.length-1]="c";break;case 11:t[t.length-1]="i"}}function showFixation(e,t){setTimeout(function(){$("#stimuli").attr("src",fixationPath)},t)}function clearCueInstruction(e){setTimeout(function(){"visible"==$("#cueMsg").css("visibility")&&$("#cueMsg").css("visibility","hidden")},e)}function showCue(e,t,i){setTimeout(function(){$("#stimuli").attr("src",t+e+imgExtension),$("#cueMsg").css("visibility","visible")},i)}function spatialCueInfo(e,t,i){setTimeout(function(){$("#cueMsg").text(t)},i)}function showStimulus(e,t,i){setTimeout(function(){$("#stimuli").attr("src",e+t+imgExtension)},i)}function getKeypress(e,t){setTimeout(function(){stStart=new Date,showStimulus(freudStimuliPath,stImage[stType[e]],0),rspArr.push(0),RTArr.push(0),inputRecorded=!1,document.onkeydown=function(t){if(!inputRecorded){inputRecorded=!0,t=t||window.event;var i=String.fromCharCode(t.keyCode);stEnd=new Date,RT=stEnd.getTime()-stStart.getTime(),addResponse(i,e,RT,rspArr,RTArr),i!=ansKey[e]?(showErrorMsg(errorMsg[0]),instructUser(i,0),reinforceLearning(e)):($("#rewardTitle").css("visibility","visible"),$("#rewardType").text(RT+"ms"),$("#stimuli").attr("src","images/ant/cues/blank.png"))}}},t)}function checkResponse(e,t){setTimeout(function(){inputRecorded||(inputRecorded=!0,showErrorMsg(errorMsg[1]),instructUser(0,0),reinforceLearning(t))},e)}function showErrorMsg(e){$("#errorTitle").css("visibility","visible"),$("#errorType").text(e),$("#errorMsg").css("visibility","visible")}function instructUser(e,t){setTimeout(function(){switch(e){case"M":$("#zKey").css("visibility","visible");break;case"Z":$("#mKey").css("visibility","visible");break;default:$("#bothKeys").css("visibility","visible")}},t)}function reinforceLearning(e){$("#stimuli").attr("src",instructPath+stImage[stType[e]]+imgExtension)}function showCueInfo(e,t,i){setTimeout(function(){$("#cueMsg").text(t)},i)}function findCueInfo(e,t){setTimeout(function(){switch(e){case"fixPlus":$("#cueMsg").text(cueInstruct[0]);break;case"midCue":$("#cueMsg").text(cueInstruct[1]);break;case"botCue":$("#cueMsg").text(cueInstruct[2]);break;case"topCue":$("#cueMsg").text(cueInstruct[3]);break;case"bothCue":$("#cueMsg").text(cueInstruct[4])}},t)}function restartTrial(){clearInterval(theTask),clearKeyboardInstructions(0),clearFeedbackInfo()}function addResponse(e,t,i,s,n){var a=/[MZ]/;e.search(a)>-1&&e===ansKey[t]?(correctAnswer.play(),s[s.length-1]=e,n[n.length-1]=i):(s[s.length-1]=0,n[n.length-1]=0)}function submitData(){trialCounter=0;var e=rspArr.join(","),t=RTArr.join(","),i=condArr.join(","),s=ansArr.join(","),n=cueArr.join(","),a=congruenceArr.join(",");$("input[name=rspStr]").val(e),$("input[name=RTStr]").val(t),$("input[name=nTrial]").val(trials),$("input[name=toa]").val(toa),$("input[name=condition]").val(i),$("input[name=ansStr]").val(s),$("input[name=cueStr]").val(n),$("input[name=congruency]").val(a),$("#restartAnt").hide(),$("#submitAnt").show()}var fixationPath="images/ant/cues/fixPlus.png",freudStimuliPath="images/ant/freud/",cuePath="images/ant/cues/",instructPath="images/ant/help/",imgExtension=".png",toa=5e3,preFixTime=500,loadTime=[500,600,700,800,900,1e3,1100,1200],cueTime=1e3,postCueFixTime=400,maxTgTime=1500,trialCounter,trials=47,cue=["fixPlus","midCue","botCue","topCue","bothCue"],activeCue=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4],condition=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47],stImage=["T_L_N","T_L_C","T_L_I","T_R_N","T_R_C","T_R_I","B_L_N","B_L_C","B_L_I","B_R_N","B_R_C","B_R_I"],stType=[0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11,0,1,2,3,4,5,6,7,8,9,10,11],ansKey=["Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M","Z","Z","Z","M","M","M"],theTask,rspArr=[],RTArr=[],condArr=[],ansArr=[],cueArr=[],congruenceArr=[],inputRecorded,stStart,stEnd,RT,correctAnswer=new Audio("audio/correctAnswer.mp3"),errorMsg=["Incorrect key pressed","Time elapsed (> 2 secs)"],cueInstruct=["A 'fixation' will appear before and after each cue.","The 'mid cue' tells you when the stimulus will appear. It does not tell you where on the screen it will show up.","The 'bottom' cue means that the target will appear at the bottom.","The 'top' cue means that the target will appear at the top.","Sometimes, both top and bottom cues will appear at the same time. This means that that the stimulus can appear on top or bottom."];$(document).ready(function(){$("#restartAnt").hide(),$("#submitAnt").hide(),$("#antDebrief").hide(),$(".tab li #antFeedbackInstruct").addClass("activeTab"),$("#startAnt").click(function(){clearStimulus(0),clearKeyboardInstructions(0),clearFeedbackInfo(),$("#startAnt").hide(),$("#restartAnt").show(),$("#stimuliContainer").css("background-color","#eee"),displayCueInformation()}),$("#restartAnt").click(function(){restartTrial(),$("#restartAnt").hide(),$("#startAnt").show(),$("#stimuliContainer").css("background-color","#fff"),$("#stimuli").attr("src","images/antImage.png")}),$("#submitAnt").click(function(){$.post("php-includes/antForm.php",{response:$("input[name=rspStr]").val(),RT:$("input[name=RTStr]").val(),nTrial:$("input[name=nTrial]").val(),toa:$("input[name=toa]").val(),condition:$("input[name=condition]").val(),ansStr:$("input[name=ansStr]").val(),cueStr:$("input[name=cueStr]").val(),congruency:$("input[name=congruency]").val()},function(e){$(".tab li #antFeedbackInstruct").removeClass("activeTab"),$(".tab li #antFeedbackResults").addClass("activeTab"),$("#errorMsg").hide(),$("#stimuliContainer").css("background-color","#eee"),$("#antDebrief").css("visibility","visible"),$("#antDebrief").show(),$("#antDebrief").html(e),$("#submitAnt").hide()})})});